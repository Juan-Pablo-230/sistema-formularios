<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Asistencia - Clases</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div class="container">
        <header class="main-header">
            <div class="header-content">
                <div class="header-text">
                    <h1>Sistema de inscripciones</h1>
                    <p>Seleccione la clase para registrar la inscripcion</p>
                </div>
                
                <div class="user-section">
                    <div id="userInfo" class="user-info" style="display: none;">
                        <div class="user-welcome">
                            <span id="userName"></span>
                        </div>
                        <div class="user-actions">
                            <button id="updateProfileBtn" class="update-profile-btn">
                                ‚úèÔ∏è Mi perfil
                            </button>
                            <button id="logoutBtn" class="logout-btn">üö™ Cerrar Sesi√≥n</button>
                        </div>
                    </div>
                    
                    <!-- Secci√≥n para usuarios no logueados -->
                    <div id="guestInfo" class="guest-info" style="display: none;">
                        <div class="guest-welcome">
                            <span>üë§ Invitado</span>
                        </div>
                        <div class="guest-actions">
                            <button id="loginBtn" class="login-btn">üîë Iniciar Sesi√≥n</button>
                            <button id="registerBtn" class="register-btn">üìù Registrarse</button>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        
        <div class="search-container">
            <div class="search-box">
                <p>Escribe aqui el nombre de la clase para buscar su formulario:</p>
                <input type="text" id="searchInput" class="form-control" placeholder="introduce el nombre de la clase.">
                <div id="searchResults" class="search-results"></div>
            </div>
        </div>

        <div class="main-layout">
            <!-- Columna izquierda: Clases principales -->
            <div class="left-column">
                <div class="classes-grid">

                    <div class="class-card" onclick="window.location.href='/Protocolos/index.html'">
                        <h3>Elaboraci√≥n de Protocolos</h3>
                        <p>Dr. Pedro Mundel.</p>
                        <span class="class-date">Clase dia 05/02/2026</span>
                    </div>

                    <div class="class-card" onclick="window.location.href='/Rotacion/index.html'">
                        <h3>Rotaci√≥n de Personal</h3>
                        <p>Lic. Karina Raihy <br>
                        Lic. Lilian Toledo.</p>
                        <span class="class-date">Clase dia 11/02/2026</span>
                    </div>

                    <div class="class-card" onclick="window.location.href='/Ausentismo/index.html'">
                        <h3>Ausentismo</h3>
                        <p>Lic. Mercedes Sosa.</p>
                        <span class="class-date">Clase dia 19/02/2026</span>
                    </div>

                    <div class="class-card" onclick="window.location.href='/Stroke/index.html'">
                        <h3>Stroke / IAM</h3>
                        <p>Lic. Daniel de la Rosa <br>
                        Lic. Liliana Areco.</p>
                        <span class="class-date">Clase dia 24/02/2026</span>
                    </div>

                    <div class="class-card" onclick="window.location.href='/Stroke/index.html'">
                        <h3>CoPaP</h3>
                        <p>Lic. Karina Raihy <br>
                        Enf. Sara Aiduc.</p>
                        <span class="class-date">Clase dia 25/02/2026</span>
                    </div>

                    <div class="class-card" onclick="window.location.href='/material.html'">
                        <h3>Solicitud Material de clases.</h3>
                        <p>Por este medio solo podras solicitar material de clase, no es valido como formulario de asistencia</p>
                        <span class="class-date">No hay clases disponibles para solicitar</span>
                    </div>
                </div>

                <!-- Secci√≥n de Video -->
                <div class="video-section">
                    <div class="video-container">
                        <div class="video-header">
                            <h2>Video instructivo del sistema.</h2>
                            <p>Mira este tutorial para aprender a usar correctamente el sistema de inscripciones</p>
                        </div>
                        <div class="video-wrapper">
                            <iframe width="560" height="315" 
                                    src="https://www.youtube.com/embed/1He-QhC2WOo?si=4ptWjDUuRr7Eg9gf" 
                                    title="YouTube video player" 
                                    frameborder="0" 
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                                    referrerpolicy="strict-origin-when-cross-origin" 
                                    allowfullscreen>
                            </iframe>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Columna derecha: Calendario ICS -->
            <div class="right-column">
                <div class="calendar-sidebar">
                    <div class="calendar-header">
                        <h3>üìÖ Calendario ICS</h3>
                        <p>Agrega clases a tu calendario personal</p>
                    </div>
                    
                    <!-- Configuraci√≥n de recordatorios -->
                    <div class="calendar-settings">
                        <h4>‚è∞ Recordatorios:</h4>
                        <div class="reminder-grid">
                            <label><input type="checkbox" class="reminder-checkbox" value="10" checked> 10 min</label>
                            <label><input type="checkbox" class="reminder-checkbox" value="30" checked> 30 min</label>
                            <label><input type="checkbox" class="reminder-checkbox" value="60" checked> 1 hora</label>
                            <label><input type="checkbox" class="reminder-checkbox" value="180"> 3 horas</label>
                            <label><input type="checkbox" class="reminder-checkbox" value="1440"> 1 d√≠a</label>
                            <label><input type="checkbox" class="reminder-checkbox" value="10080"> 1 semana</label>
                        </div>
                    </div>
                    
                    <!-- Lista de clases para agregar al calendario -->
                    <div class="calendar-classes-list">
                        <h4>Clases Disponibles:</h4>
                        
                        <!-- Clase 1 -->
                        <div class="calendar-class-card" data-class-id="1">
                            <div class="class-info">
                                <div class="class-title">Elaboraci√≥n de Protocolos</div>
                                <div class="class-details">
                                    <span class="detail-item">üìÖ 05/02/2026</span>
                                    <span class="detail-item">üïí 09:00hs</span>
                                    <span class="detail-item modality virtual">Virtual</span>
                                </div>
                                <div class="class-instructor">Dr. Pedro Mundel</div>
                            </div>
                            <button class="add-to-calendar-btn" onclick="calendarManager.addToCalendar(1)">
                                + Agregar a .ics
                            </button>
                        </div>
                        
                        <!-- Clase 2 -->
                        <div class="calendar-class-card" data-class-id="2">
                            <div class="class-info">
                                <div class="class-title">Rotaci√≥n de Personal</div>
                                <div class="class-details">
                                    <span class="detail-item">üìÖ 11/02/2026</span>
                                    <span class="detail-item">üïí 14:00hs</span>
                                    <span class="detail-item modality virtual">Virtual</span>
                                </div>
                                <div class="class-instructor">Lic. Romina Seminario, Lic. Lilian Toledo</div>
                            </div>
                            <button class="add-to-calendar-btn" onclick="calendarManager.addToCalendar(2)">
                                + Agregar a .ics
                            </button>
                        </div>
                        
                        <!-- Clase 3 -->
                        <div class="calendar-class-card" data-class-id="3">
                            <div class="class-info">
                                <div class="class-title">Ausentismo</div>
                                <div class="class-details">
                                    <span class="detail-item">üìÖ 19/02/2026</span>
                                    <span class="detail-item">üïí 10:00hs</span>
                                    <span class="detail-item modality presencial">Presencial</span>
                                    <!-- <span class="detail-item modality hibrida">H√≠brida</span> -->
                                </div>
                                <div class="class-instructor">Lic. Mercedes Sosa</div>
                            </div>
                            <button class="add-to-calendar-btn" onclick="calendarManager.addToCalendar(3)">
                                + Agregar a .ics
                            </button>
                        </div>
                        
                        <!-- Clase 4 -->
                        <div class="calendar-class-card" data-class-id="4">
                            <div class="class-info">
                                <div class="class-title">Stroke / IAM</div>
                                <div class="class-details">
                                    <span class="detail-item">üìÖ 24/02/2026</span>
                                    <span class="detail-item">üïí 09:00hs</span>
                                    <span class="detail-item modality virtual">Virtual</span>
                                </div>
                                <div class="class-instructor">Lic. Daniel de la Rosa, Lic. Liliana Areco</div>
                            </div>
                            <button class="add-to-calendar-btn" onclick="calendarManager.addToCalendar(4)">
                                + Agregar a .ics
                            </button>
                        </div>
                        
                        <!-- Clase 5 -->
                        <div class="calendar-class-card" data-class-id="5">
                            <div class="class-info">
                                <div class="class-title">CoPaP</div>
                                <div class="class-details">
                                    <span class="detail-item">üìÖ 25/02/2026</span>
                                    <span class="detail-item">üïí 15:00hs</span>
                                    <span class="detail-item modality virtual">Virtual</span>
                                </div>
                                <div class="class-instructor">Lic. Karina Raihy, Enf. Sara Aiduc</div>
                            </div>
                            <button class="add-to-calendar-btn" onclick="calendarManager.addToCalendar(5)">
                                + Agregar a .ics
                            </button>
                        </div>
                    </div>
                    
                    <!-- Acciones del calendario -->
                    <div class="calendar-actions">
                        <div class="selected-count">
                            <span id="selectedClassesCount">0</span> clases seleccionadas
                        </div>
                        
                        <div class="action-buttons">
                            <button id="downloadSelectedBtn" class="download-selected-btn" onclick="calendarManager.downloadSelected()">
                                üì• Descargar Seleccionadas (.ics)
                            </button>
                            <button id="downloadAllBtn" class="download-all-btn" onclick="calendarManager.downloadAll()">
                                üì• Descargar Todas (.ics)
                            </button>
                        </div>
                    </div>
                    
                    <!-- Vista previa de selecci√≥n -->
                    <div class="selection-preview" id="selectionPreview">
                        <h4>üìã Vista Previa:</h4>
                        <div class="preview-list" id="previewList">
                            <div class="empty-preview">No hay clases seleccionadas</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div> <!-- Cierre del container -->

    <div id="updateProfileModal" class="modal-overlay" style="display: none;">
        <!-- Mantener el contenido existente del modal -->
        <div class="modal-container">
            <div class="modal-header">
                <h2>‚úèÔ∏è Mi perfil</h2>
                <button class="close-modal">&times;</button>
            </div>
            
            <div class="modal-tabs">
                <button class="modal-tab active" data-tab="update">Actualizar perfil</button>
                <button class="modal-tab" data-tab="delete">Eliminar cuenta</button>
            </div>

            <div id="updateTab" class="modal-tab-content active">
                <form id="updateProfileForm" class="modal-form">
                    <div class="security-notice">
                        ‚ö†Ô∏è Para modificar sus datos, debe ingresar su contrase√±a actual
                    </div>

                    <div class="form-group">
                        <label for="updateCurrentPassword">Contrase√±a Actual *</label>
                        <div class="password-field">
                            <input type="password" id="updateCurrentPassword" name="currentPassword" required>
                            <button type="button" class="toggle-password">üëÅÔ∏è</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="updateApellidoNombre">Apellido y Nombre *</label>
                        <input type="text" id="updateApellidoNombre" name="apellidoNombre" required>
                    </div>

                    <div class="form-group">
                        <label for="updateLegajo">N√∫mero de Legajo *</label>
                        <input type="number" id="updateLegajo" name="legajo" required>
                        <small class="legajo-warning" style="display: none;">
                            ‚ö†Ô∏è Este legajo ya est√° registrado. Use su cuenta existente.
                        </small>
                    </div>

                    <div class="form-group">
                        <label for="updateTurno">Turno de Trabajo *</label>
                        <select id="updateTurno" name="turno" required>
                            <option value="">Seleccione turno</option>
                            <option value="Turno ma√±ana">Turno ma√±ana</option>
                            <option value="Turno tarde">Turno tarde</option>
                            <option value="Turno noche A">Turno noche A</option>
                            <option value="Turno noche B">Turno noche B</option>
                            <option value="Turno intermedio">Turno intermedio</option>
                            <option value="Turno SADOFE">Turno S√°bado, Domingo y feriado</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="updateEmail">Correo Electr√≥nico *</label>
                        <input type="email" id="updateEmail" name="email" required>
                    </div>

                    <div class="password-section">
                        <h4>Cambiar Contrase√±a (opcional)</h4>
                        <div class="form-group">
                            <label for="updatePassword">Nueva Contrase√±a</label>
                            <div class="password-field">
                                <input type="password" id="updatePassword" name="password" placeholder="M√≠nimo 6 caracteres">
                                <button type="button" class="toggle-password">üëÅÔ∏è</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="updateConfirmPassword">Confirmar Nueva Contrase√±a</label>
                            <div class="password-field">
                                <input type="password" id="updateConfirmPassword" name="confirmPassword">
                                <button type="button" class="toggle-password">üëÅÔ∏è</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="submit-btn">üíæ Guardar Cambios</button>
                        <button type="button" class="cancel-btn">‚ùå Cancelar</button>
                    </div>
                </form>
            </div>

            <div id="deleteTab" class="modal-tab-content">
                <div class="delete-warning">
                    <div class="warning-icon">‚ö†Ô∏è</div>
                    <h3>Eliminar la cuenta de forma permanentemente</h3>
                    <p><strong>Importante:</strong> Esta acci√≥n no se puede deshacer.</p>
                    
                    <div class="warning-details">
                        <h4>¬øQu√© se eliminar√°?</h4>
                        <ul>
                            <li>‚úÖ Sus datos personales de la cuenta</li>
                            <li>‚úÖ Su informaci√≥n de acceso</li>
                        </ul>

                        <h4>¬øQu√© NO se eliminar√°?</h4>
                        <ul>
                            <li>‚ùå Las respuestas de formularios ya completados</li>
                            <li>‚ùå Las inscripciones a clases realizadas</li>
                            <li>‚ùå Los registros de asistencia</li>
                        </ul>

                        <p class="important-note">
                            <strong>Nota:</strong> Los formularios que ya complet√≥ permanecer√°n en el sistema 
                            para fines de registro y estad√≠sticas, pero sin sus datos personales asociados.
                        </p>
                    </div>

                    <form id="deleteAccountForm" class="modal-form">
                        <div class="form-group">
                            <label for="deleteCurrentPassword">Ingrese su contrase√±a actual *</label>
                            <div class="password-field">
                                <input type="password" id="deleteCurrentPassword" name="currentPassword" required>
                                <button type="button" class="toggle-password">üëÅÔ∏è</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="deleteConfirmation">
                                <input type="checkbox" id="deleteConfirmation" name="confirmation" required>
                                Entiendo que esta acci√≥n es irreversible y acepto que mis formularios 
                                completados permanecer√°n en el sistema.
                            </label>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="delete-account-btn">üóëÔ∏è Eliminar cuenta</button>
                            <button type="button" class="cancel-btn">‚ùå Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/auth.js"></script>
    <script src="/js/search.js"></script>
    <script src="/js/profile-updater.js"></script>
    <script src="/js/calendar.js"></script>
</body>
</html>