<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de AdministraciÃ³n - Sistema de Asistencia</title>
    <link rel="stylesheet" href="/css/admin.css">
    <style>
        .gestion-visual-grid { display: grid; grid-template-columns: 350px 1fr; gap: 20px; align-items: start; }
        .form-panel { position: sticky; top: 20px; }
        .url-entry { background: var(--bg-card); padding: 8px; border-radius: 6px; border: 1px solid var(--border-color); margin-bottom: 5px; display: flex; gap: 5px; align-items: center; }
        .clase-card-admin { background: var(--bg-container); padding: 15px; border-radius: 10px; margin-bottom: 12px; border: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; }
        .btn-small { padding: 5px 10px; font-size: 0.85em; }
        @media (max-width: 900px) { .gestion-visual-grid { grid-template-columns: 1fr; } .form-panel { position: static; } }
    </style>
</head>
<body>
    <div class="admin-container">
        <header class="admin-header">
            <h1>ğŸ“Š Panel de AdministraciÃ³n</h1>
            <div class="admin-info">
                <span>ğŸ‘¤ <span id="adminName">Cargando...</span></span>
                <span>ğŸ“§ <span id="adminEmail"></span></span>
                <span id="adminRole" class="role-badge"></span>
                <button id="homeBtn" class="btn btn-primary">ğŸ  Inicio</button>
                <button id="logoutBtn" class="btn btn-danger">ğŸšª Cerrar SesiÃ³n</button>
            </div>
        </header>

        <div class="view-navigation">
            <button id="btnInscripciones" class="view-btn active">ğŸ“‹ Inscripciones</button>
            <button id="btnUsuarios" class="view-btn">ğŸ‘¥ Usuarios</button>
            <button id="btnMaterial" class="view-btn">ğŸ“š Pendientes</button>
            <button id="btnMaterialHistorico" class="view-btn">ğŸ“– HistÃ³rico</button>
            <button id="btnGestionClasesVisual" class="view-btn">ğŸ¯ GestiÃ³n Visual</button>
        </div>

        <div class="stats-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 25px;">
            <div class="stat-card" style="background: #4285f4; color: white; padding: 15px; border-radius: 8px; text-align: center;">
                <div>Inscripciones</div>
                <div id="statsInscripciones" style="font-size: 1.8em; font-weight: bold;">0</div>
            </div>
            <div class="stat-card" style="background: #34a853; color: white; padding: 15px; border-radius: 8px; text-align: center;">
                <div>Usuarios</div>
                <div id="statsUsuarios" style="font-size: 1.8em; font-weight: bold;">0</div>
            </div>
            <div class="stat-card" style="background: #f9ab00; color: white; padding: 15px; border-radius: 8px; text-align: center;">
                <div>Material Pendiente</div>
                <div id="statsMaterial" style="font-size: 1.8em; font-weight: bold;">0</div>
            </div>
            <div class="stat-card" style="background: #764ba2; color: white; padding: 15px; border-radius: 8px; text-align: center;">
                <div>Total Clases</div>
                <div id="statsTotalClases" style="font-size: 1.8em; font-weight: bold;">0</div>
            </div>
        </div>

        <div id="inscripcionesSection" class="table-container">
            <div class="actions-bar">
                <div id="filtrosInscripciones"></div>
                <button id="refreshBtn" class="btn btn-secondary">ğŸ”„ Actualizar</button>
                <button id="exportExcelBtn" class="btn btn-success">ğŸ“Š Excel</button>
            </div>
            <table class="inscripciones-table">
                <thead><tr><th>Fecha</th><th>Nombre</th><th>Legajo</th><th>Turno</th><th>Clase</th></tr></thead>
                <tbody id="inscripcionesBody"></tbody>
            </table>
        </div>

        <div id="usuariosSection" class="table-container" style="display: none;">
            <table class="inscripciones-table">
                <thead><tr><th>Nombre</th><th>Legajo</th><th>Email</th><th>Rol</th><th>Acciones</th></tr></thead>
                <tbody id="usuariosBody"></tbody>
            </table>
        </div>

        <div id="materialSection" class="table-container" style="display: none;">
            <div id="filtrosMaterial"></div>
            <table class="inscripciones-table">
                <thead><tr><th>Fecha</th><th>Usuario</th><th>Legajo</th><th>Clase</th><th>Acciones</th></tr></thead>
                <tbody id="materialBody"></tbody>
            </table>
        </div>

        <div id="materialHistoricoSection" class="table-container" style="display: none;">
            <table class="inscripciones-table">
                <thead><tr><th>Usuario</th><th>Clase</th><th>Fecha</th><th>Acciones</th></tr></thead>
                <tbody id="materialHistoricoBody"></tbody>
            </table>
        </div>

        <div id="gestionClasesVisualSection" class="table-container" style="display: none;">
            <div class="gestion-visual-grid">
                <div class="form-panel" style="background: var(--bg-card); padding: 20px; border-radius: 10px; border: 1px solid var(--border-color);">
                    <h3 id="tituloFormularioClase">â• GestiÃ³n de Clase</h3>
                    <form id="formClaseHistorica" novalidate>
                        <input type="hidden" id="claseIdEdit">
                        <div class="form-group">
                            <label>Nombre Clase *</label>
                            <input type="text" id="claseNombre" style="width:100%; padding:8px; margin-top:5px;">
                        </div>
                        <div style="display: flex; gap: 10px; margin-top:10px;">
                            <div style="flex:1;">
                                <label>Fecha *</label>
                                <input type="date" id="claseFecha" style="width:100%; padding:8px;">
                            </div>
                            <div style="flex:1;">
                                <label>Hora</label>
                                <input type="time" id="claseHora" value="10:00" style="width:100%; padding:8px;">
                            </div>
                        </div>
                        <div style="margin-top:10px;">
                            <label>Instructores</label>
                            <input type="text" id="claseInstructores" placeholder="Separados por coma..." style="width:100%; padding:8px;">
                        </div>
                        <div style="margin-top:15px; border-top: 1px solid #ddd; padding-top:10px;">
                            <div style="display:flex; justify-content:space-between; align-items:center;">
                                <strong>ğŸ”— Enlaces</strong>
                                <button type="button" id="btnAgregarUrl" class="btn-small btn-primary">â•</button>
                            </div>
                            <div id="urlsContainer" style="margin-top:10px;"></div>
                        </div>
                        <div style="margin-top:15px;">
                            <label>Estado *</label>
                            <select id="claseEstado" style="width:100%; padding:8px;">
                                <option value="Activa">Activa</option>
                                <option value="Publicada">Publicada</option>
                                <option value="Cancelada">Cancelada</option>
                            </select>
                        </div>
                        <div style="display:flex; gap:10px; margin-top:20px;">
                            <button type="submit" id="btnSubmitClase" class="btn btn-success" style="flex:2;">ğŸ’¾ Guardar</button>
                            <button type="button" id="btnLimpiarForm" class="btn btn-secondary" style="flex:1;">ğŸ—‘ï¸</button>
                        </div>
                    </form>
                    <div id="formMensaje" style="margin-top:10px; display:none; padding:8px; border-radius:5px; text-align:center;"></div>
                </div>
                <div class="list-panel">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                        <h3>ğŸ“‹ Clases</h3>
                        <button id="btnRefrescarClases" class="btn btn-small">ğŸ”„</button>
                    </div>
                    <div id="clasesListContainer"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/auth.js"></script>
    <script src="/js/admin.js"></script>
    <script src="/js/gestion-clases-visual.js"></script>
</body>
</html>