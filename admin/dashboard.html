<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administraci√≥n</title>
    <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
    <div class="admin-container">
        <header class="admin-header">
            <h1>üìä Panel de Administraci√≥n</h1>
            <div class="admin-info">
                <span>üë§ <span id="adminName"></span></span>
                <span>üìß <span id="adminEmail"></span></span>
                <span id="adminRole"></span>
                <button id="homeBtn" class="btn btn-primary">üè† Inicio</button>
                <button id="logoutBtn" class="btn btn-danger">üö™ Cerrar Sesi√≥n</button>
            </div>
        </header>

        <!-- Navegaci√≥n entre vistas -->
        <div class="view-navigation">
            <button id="btnInscripciones" class="view-btn active">üìã Inscripciones</button>
            <button id="btnUsuarios" class="view-btn">üë• Gesti√≥n de Usuarios</button>
            <button id="btnMaterial" class="view-btn">üìö Solicitudes de Material</button>
        </div>

        <!-- Estad√≠sticas din√°micas -->
        <div class="stats-container" id="statsInscripciones">
            <div class="stat-card">
                <h3>Total Inscripciones</h3>
                <div class="stat-number" id="totalInscripciones">0</div>
            </div>
            <div class="stat-card">
                <h3>√öltima Inscripci√≥n</h3>
                <div class="stat-text" id="ultimaInscripcion">-</div>
            </div>
        </div>

        <div class="stats-container" id="statsUsuarios" style="display: none;">
            <div class="stat-card">
                <h3>Total Usuarios</h3>
                <div class="stat-number" id="totalUsuarios">0</div>
            </div>
            <div class="stat-card">
                <h3>Administradores</h3>
                <div class="stat-number" id="usuariosAdmin">0</div>
            </div>
            <div class="stat-card">
                <h3>Usuarios Avanzados</h3>
                <div class="stat-number" id="usuariosAvanzados">0</div>
            </div>
            <div class="stat-card">
                <h3>Usuarios Est√°ndar</h3>
                <div class="stat-number" id="usuariosEstandar">0</div>
            </div>
        </div>

        <div class="stats-container" id="statsMaterial" style="display: none;">
            <div class="stat-card">
                <h3>Total Solicitudes</h3>
                <div class="stat-number" id="totalSolicitudes">0</div>
            </div>
            <div class="stat-card">
                <h3>Solicitudes Hoy</h3>
                <div class="stat-number" id="solicitudesHoy">0</div>
            </div>
            <div class="stat-card">
                <h3>Clase M√°s Solicitada</h3>
                <div class="stat-text" id="clasePopular">-</div>
            </div>
        </div>

        <!-- Secci√≥n de filtros para inscripciones -->
        <div class="filtros-container" id="filtrosInscripciones">
            <label for="filtroClase">Filtrar por clase:</label>
            <div id="filtroContainer"></div>
            <div class="contador-resultados" id="contadorResultados">0 inscripciones en total</div>
        </div>

        <!-- Secci√≥n de filtros para material -->
        <div class="filtros-container" id="filtrosMaterial" style="display: none; margin-bottom: 20px;">
            <label for="filtroClaseMaterialAdmin">Filtrar por clase:</label>
            <select id="filtroClaseMaterialAdmin" class="filtro-select">
                <option value="todas">Todas las clases</option>
            </select>
            
            <div class="contador-resultados" id="contadorMaterialAdmin">
                0 solicitudes en total
            </div>
            
            <button id="btnExportarCorreosAdmin" class="btn btn-success" style="display: none;">
                üìß Exportar Correos (.txt)
            </button>
        </div>

        <div class="actions-bar">
            <button id="refreshBtn" class="btn btn-primary">üîÑ Actualizar Datos</button>
            <button id="exportBtn" class="btn btn-success">üì• Exportar a CSV</button>
            <button id="createUserBtn" class="btn btn-warning" style="display: none;">‚ûï Crear Usuario</button>
        </div>

        <!-- Secci√≥n de Inscripciones -->
        <div class="table-container" id="inscripcionesSection">
            <h2>üìã Lista de Inscripciones</h2>
            <table class="inscripciones-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Apellido y Nombre</th>
                        <th>Legajo</th>
                        <th>Clase</th>
                        <th>Turno</th>
                        <th>Email</th>
                        <th>Fecha</th>
                    </tr>
                </thead>
                <tbody id="inscripcionesBody">
                </tbody>
            </table>
        </div>

        <!-- Secci√≥n de Gesti√≥n de Usuarios (Solo para admins) -->
        <div class="table-container" id="usuariosSection" style="display: none;">
            <h2>üë• Gesti√≥n de Usuarios Registrados</h2>
            <table class="inscripciones-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Apellido y Nombre</th>
                        <th>Legajo</th>
                        <th>Email</th>
                        <th>Turno</th>
                        <th>Rol</th>
                        <th>Fecha Registro</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="usuariosBody">
                </tbody>
            </table>
        </div>

        <!-- Secci√≥n de Solicitudes de Material -->
        <div class="table-container" id="materialSection" style="display: none;">
            <h2>üìö Solicitudes de Material por Clase</h2>
            
            <table class="inscripciones-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Apellido y Nombre</th>
                        <th>Legajo</th>
                        <th>Clase</th>
                        <th>Email</th>
                        <th>Fecha Solicitud</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="materialBodyAdmin">
                    <tr>
                        <td colspan="7" style="text-align: center; color: #666; padding: 20px;">
                            No hay solicitudes de material
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal de Crear Usuario -->
    <div id="createUserModal" class="modal-overlay" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h2>‚ûï Crear Nuevo Usuario</h2>
                <button class="close-modal">&times;</button>
            </div>
            <form id="createUserForm" class="modal-form">
                <div class="form-group">
                    <label for="createApellidoNombre">Apellido y Nombre *</label>
                    <input type="text" id="createApellidoNombre" name="apellidoNombre" required>
                </div>
                <div class="form-group">
                    <label for="createLegajo">N√∫mero de Legajo *</label>
                    <input type="number" id="createLegajo" name="legajo" required>
                </div>
                <div class="form-group">
                    <label for="createEmail">Correo Electr√≥nico *</label>
                    <input type="email" id="createEmail" name="email" required>
                </div>
                <div class="form-group">
                    <label for="createTurno">Turno de Trabajo *</label>
                    <select id="createTurno" name="turno" required>
                        <option value="">Seleccione turno</option>
                        <option value="Turno ma√±ana">Turno ma√±ana</option>
                        <option value="Turno tarde">Turno tarde</option>
                        <option value="Turno noche A">Turno noche A</option>
                        <option value="Turno noche B">Turno noche B</option>
                        <option value="Turno intermedio">Turno intermedio</option>
                        <option value="S√°bado, Domingo y feriado">S√°bado, Domingo y feriado</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="createRole">Rol *</label>
                    <select id="createRole" name="role" required>
                        <option value="user">Usuario Est√°ndar</option>
                        <option value="advanced">Usuario Avanzado</option>
                        <option value="admin">Administrador</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="createPassword">Contrase√±a Temporal *</label>
                    <input type="password" id="createPassword" name="password" value="temp123" required>
                    <small>El usuario podr√° cambiar esta contrase√±a despu√©s</small>
                </div>
                <div class="form-actions">
                    <button type="submit" class="submit-btn">üíæ Crear Usuario</button>
                    <button type="button" class="cancel-btn">‚ùå Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Editar Usuario -->
    <div id="editUserModal" class="modal-overlay" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h2>‚úèÔ∏è Editar Usuario</h2>
                <button class="close-modal">&times;</button>
            </div>
            <form id="editUserForm" class="modal-form">
                <input type="hidden" id="editUserId">
                <div class="form-group">
                    <label for="editApellidoNombre">Apellido y Nombre *</label>
                    <input type="text" id="editApellidoNombre" name="apellidoNombre" required>
                </div>
                <div class="form-group">
                    <label for="editLegajo">N√∫mero de Legajo *</label>
                    <input type="number" id="editLegajo" name="legajo" required>
                </div>
                <div class="form-group">
                    <label for="editEmail">Correo Electr√≥nico *</label>
                    <input type="email" id="editEmail" name="email" required>
                </div>
                <div class="form-group">
                    <label for="editTurno">Turno de Trabajo *</label>
                    <select id="editTurno" name="turno" required>
                        <option value="">Seleccione turno</option>
                        <option value="Turno ma√±ana">Turno ma√±ana</option>
                        <option value="Turno tarde">Turno tarde</option>
                        <option value="Turno noche A">Turno noche A</option>
                        <option value="Turno noche B">Turno noche B</option>
                        <option value="Turno intermedio">Turno intermedio</option>
                        <option value="S√°bado, Domingo y feriado">S√°bado, Domingo y feriado</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="submit" class="submit-btn">üíæ Guardar Cambios</button>
                    <button type="button" class="cancel-btn">‚ùå Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Cambiar Contrase√±a -->
    <div id="changePasswordModal" class="modal-overlay" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h2>üîê Cambiar Contrase√±a</h2>
                <button class="close-modal">&times;</button>
            </div>
            <form id="changePasswordForm" class="modal-form">
                <input type="hidden" id="changePasswordUserId">
                
                <div class="user-info-preview">
                    <h4>Informaci√≥n del Usuario</h4>
                    <div class="info-grid">
                        <div class="info-item">
                            <label>Nombre:</label>
                            <div class="info-value" id="changePasswordUserName">-</div>
                        </div>
                        <div class="info-item">
                            <label>Legajo:</label>
                            <div class="info-value" id="changePasswordUserLegajo">-</div>
                        </div>
                        <div class="info-item">
                            <label>Email:</label>
                            <div class="info-value" id="changePasswordUserEmail">-</div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="newPassword">Nueva Contrase√±a *</label>
                    <div style="position: relative;">
                        <input type="password" id="newPassword" name="newPassword" required 
                               placeholder="Ingrese la nueva contrase√±a" minlength="6">
                        <button type="button" class="toggle-password" style="
                            position: absolute;
                            right: 10px;
                            top: 50%;
                            transform: translateY(-50%);
                            background: none;
                            border: none;
                            cursor: pointer;
                            color: var(--text-muted);
                            font-size: 14px;
                        ">üëÅÔ∏è</button>
                    </div>
                    <small class="field-info">M√≠nimo 6 caracteres</small>
                </div>

                <div class="form-group">
                    <label for="confirmNewPassword">Confirmar Nueva Contrase√±a *</label>
                    <div style="position: relative;">
                        <input type="password" id="confirmNewPassword" name="confirmNewPassword" required 
                               placeholder="Confirme la nueva contrase√±a">
                        <button type="button" class="toggle-password" style="
                            position: absolute;
                            right: 10px;
                            top: 50%;
                            transform: translateY(-50%);
                            background: none;
                            border: none;
                            cursor: pointer;
                            color: var(--text-muted);
                            font-size: 14px;
                        ">üëÅÔ∏è</button>
                    </div>
                </div>

                <div class="password-info">
                    <div class="password-notice">
                        <h4>‚ö†Ô∏è Informaci√≥n Importante</h4>
                        <p>‚Ä¢ El usuario deber√° usar esta contrase√±a para iniciar sesi√≥n</p>
                        <p>‚Ä¢ Se recomienda usar una contrase√±a temporal que el usuario cambie despu√©s</p>
                        <p>‚Ä¢ Notifique al usuario sobre el cambio de contrase√±a</p>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="submit-btn">üíæ Cambiar Contrase√±a</button>
                    <button type="button" class="cancel-btn">‚ùå Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <script src="/js/auth.js"></script>
    <script src="/js/admin.js"></script>
</body>
</html>