<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de AdministraciÃ³n</title>
    <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
    <div class="admin-container">
        <header class="admin-header">
            <h1>ğŸ“Š Panel de AdministraciÃ³n</h1>
            <div class="admin-info">
                <span>ğŸ‘¤ <span id="adminName"></span></span>
                <span>ğŸ“§ <span id="adminEmail"></span></span>
                <span id="adminRole"></span>
                <button id="homeBtn" class="btn btn-primary">ğŸ  Inicio</button>
                <button id="logoutBtn" class="btn btn-danger">ğŸšª Cerrar SesiÃ³n</button>
            </div>
        </header>

        <!-- NavegaciÃ³n entre vistas -->
        <div class="view-navigation">
            <button id="btnInscripciones" class="view-btn active">ğŸ“‹ Inscripciones</button>
            <button id="btnUsuarios" class="view-btn">ğŸ‘¥ GestiÃ³n de Usuarios</button>
            <button id="btnMaterial" class="view-btn">ğŸ“š Solicitudes de Material</button>
            <button id="btnMaterialHistorico" class="view-btn">ğŸ“š Material HistÃ³rico</button>
            <button id="btnGestionClasesVisual" class="view-btn">ğŸ¯ GestiÃ³n Visual de Clases</button>
        </div>

        <!-- EstadÃ­sticas dinÃ¡micas -->
        <div class="stats-container" id="statsInscripciones">
            <div class="stat-card">
                <h3>Total Inscripciones</h3>
                <div class="stat-number" id="totalInscripciones">0</div>
            </div>
        </div>

        <div class="stats-container" id="statsUsuarios" style="display: none;">
            <div class="stat-card">
                <h3>Total Usuarios</h3>
                <div class="stat-number" id="totalUsuarios">0</div>
            </div>
            <div class="stat-card">
                <h3>Administradores</h3>
                <div class="stat-number" id="usuariosAdmin">0</div>
            </div>
            <div class="stat-card">
                <h3>Usuarios Avanzados</h3>
                <div class="stat-number" id="usuariosAvanzados">0</div>
            </div>
            <div class="stat-card">
                <h3>Usuarios EstÃ¡ndar</h3>
                <div class="stat-number" id="usuariosEstandar">0</div>
            </div>
        </div>

        <div class="stats-container" id="statsMaterial" style="display: none;">
            <div class="stat-card">
                <h3>Total Solicitudes</h3>
                <div class="stat-number" id="totalSolicitudes">0</div>
            </div>
            <div class="stat-card">
                <h3>Solicitudes Hoy</h3>
                <div class="stat-number" id="solicitudesHoy">0</div>
            </div>
        </div>

        <!-- SecciÃ³n de filtros para inscripciones -->
        <div class="filtros-container" id="filtrosInscripciones">
            <label>Filtrar por clase:</label>
            <div id="filtroContainer"></div>
            <div class="contador-resultados" id="contadorResultados">0 inscripciones en total</div>
        </div>

        <!-- SecciÃ³n de filtros para material -->
        <div class="filtros-container" id="filtrosMaterial" style="display: none; margin-bottom: 20px;">
            <label for="filtroClaseMaterialAdmin">Filtrar por clase:</label>
            <select id="filtroClaseMaterialAdmin" class="filtro-select">
                <option value="">Todas las clases</option>
            </select>
            
            <div class="contador-resultados" id="contadorMaterialAdmin">
                0 solicitudes en total
            </div>
            
            <button id="btnExportarCorreosAdmin" class="btn btn-success" style="display: none;">
                ğŸ“§ Exportar Correos (.txt)
            </button>
        </div>

        <div class="actions-bar">
            <button id="refreshBtn" class="btn btn-primary">ğŸ”„ Actualizar Datos</button>
            <button id="exportBtn" class="btn btn-success">ğŸ“¥ Exportar a CSV</button>
            <button id="createUserBtn" class="btn btn-warning" style="display: none;">â• Crear Usuario</button>
        </div>

        <!-- SecciÃ³n de Inscripciones -->
        <div class="table-container" id="inscripcionesSection">
            <h2>ğŸ“‹ Lista de Inscripciones</h2>
            <table class="inscripciones-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Apellido y Nombre</th>
                        <th>Legajo</th>
                        <th>Clase</th>
                        <th>Turno</th>
                        <th>Email</th>
                        <th>Fecha</th>
                    </tr>
                </thead>
                <tbody id="inscripcionesBody">
                </tbody>
            </table>
        </div>

        <!-- SecciÃ³n de GestiÃ³n de Usuarios (Solo para admins) -->
        <div class="table-container" id="usuariosSection" style="display: none;">
            <h2>ğŸ‘¥ GestiÃ³n de Usuarios Registrados</h2>
            <table class="inscripciones-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Apellido y Nombre</th>
                        <th>Legajo</th>
                        <th>Email</th>
                        <th>Turno</th>
                        <th>Rol</th>
                        <th>Fecha Registro</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="usuariosBody">
                </tbody>
            </table>
        </div>

        <!-- SecciÃ³n de Solicitudes de Material -->
        <div class="table-container" id="materialSection" style="display: none;">
            <h2>ğŸ“š Solicitudes de Material por Clase</h2>
            
            <table class="inscripciones-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Apellido y Nombre</th>
                        <th>Legajo</th>
                        <th>Clase</th>
                        <th>Email</th>
                        <th>Fecha Solicitud</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="materialBodyAdmin">
                    <tr>
                        <td colspan="7" style="text-align: center; color: #666; padding: 20px;">
                            No hay solicitudes de material
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- SecciÃ³n de Solicitudes de Material HistÃ³rico (nueva) -->
         <div class="table-container" id="materialHistoricoSection" style="display: none;">
            <h2>ğŸ“š Solicitudes de Material HistÃ³rico</h2>
            <div class="stats-mini" style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
                <div class="stat-mini-card" style="background: var(--bg-card); padding: 15px; border-radius: 8px; flex: 1;">
                    <div style="font-size: 0.9em; color: var(--text-muted);">Total Solicitudes</div>
                    <div style="font-size: 1.8em; font-weight: bold;" id="totalSolicitudesHistorico">0</div>
                </div>
                <div class="stat-mini-card" style="background: var(--bg-card); padding: 15px; border-radius: 8px; flex: 1;">
                    <div style="font-size: 0.9em; color: var(--text-muted);">Clases Distintas</div>
                    <div style="font-size: 1.8em; font-weight: bold;" id="clasesDistintasHistorico">0</div>
                </div>
            </div>
            <table class="inscripciones-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Apellido y Nombre</th>
                        <th>Legajo</th>
                        <th>Clase</th>
                        <th>Email</th>
                        <th>Fecha Solicitud</th>
                        <th>Material</th>
                    </tr>
                </thead>
                <tbody id="materialHistoricoBody">
                    <tr>
                        <td colspan="7" style="text-align: center; color: #666; padding: 20px;">
                            No hay solicitudes de material histÃ³rico
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- SecciÃ³n de GestiÃ³n Visual de Clases HistÃ³ricas -->
<div class="table-container" id="gestionClasesVisualSection" style="display: none;">
    <h2>ğŸ“š GestiÃ³n Visual de Clases HistÃ³ricas</h2>
    
    <div class="gestion-container" style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px; margin-top: 20px;">
        
        <!-- Panel izquierdo - Formulario de carga -->
        <div class="form-panel" style="background: var(--bg-card); padding: 20px; border-radius: 10px;">
            <h3 style="margin-bottom: 20px; color: var(--text-primary);">â• Agregar Nueva Clase</h3>
            
            <form id="formClaseHistorica" style="display: flex; flex-direction: column; gap: 15px;">
                <div class="form-group">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Nombre de la Clase *</label>
                    <input type="text" id="claseNombre" required 
                           style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid var(--border-color); background: var(--bg-container); color: var(--text-primary);">
                </div>
                
                <div class="form-group">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">DescripciÃ³n</label>
                    <textarea id="claseDescripcion" rows="3"
                              style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid var(--border-color); background: var(--bg-container); color: var(--text-primary);"></textarea>
                </div>
                
                <div class="form-group">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Fecha de la Clase *</label>
                    <input type="date" id="claseFecha" required 
                           style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid var(--border-color); background: var(--bg-container); color: var(--text-primary);">
                </div>
                
                <div class="form-group">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Hora</label>
                    <input type="time" id="claseHora" value="10:00"
                           style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid var(--border-color); background: var(--bg-container); color: var(--text-primary);">
                </div>
                
                <div class="form-group" style="border-top: 1px solid var(--border-color); padding-top: 15px;">
                    <h4 style="margin-bottom: 15px;">ğŸ”— Enlaces del Material</h4>
                    
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">YouTube URL</label>
                    <input type="url" id="claseYoutube"
                           style="width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 5px; border: 1px solid var(--border-color); background: var(--bg-container); color: var(--text-primary);">
                    
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Presentacion</label>
                    <input type="url" id="clasePowerpoint"
                           style="width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 5px; border: 1px solid var(--border-color); background: var(--bg-container); color: var(--text-primary);">
                </div>
                
                <div class="form-group">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Instructores (separados por coma)</label>
                    <input type="text" id="claseInstructores" placeholder="Dr. Juan PÃ©rez, Lic. MarÃ­a GonzÃ¡lez"
                           style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid var(--border-color); background: var(--bg-container); color: var(--text-primary);">
                </div>
                
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="claseActiva" checked>
                        <span>Clase activa (visible para usuarios)</span>
                    </label>
                </div>
                
                <div class="form-actions" style="display: flex; gap: 10px; margin-top: 10px;">
                    <button type="submit" class="btn btn-success" style="flex: 2;">ğŸ’¾ Guardar Clase</button>
                    <button type="button" id="btnLimpiarForm" class="btn btn-secondary" style="flex: 1;">ğŸ—‘ï¸ Limpiar</button>
                </div>
            </form>
            
            <div id="formMensaje" style="margin-top: 15px; padding: 10px; border-radius: 5px; display: none;"></div>
        </div>
        
        <!-- Panel derecho - Lista de clases -->
        <div class="list-panel" style="background: var(--bg-card); padding: 20px; border-radius: 10px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="color: var(--text-primary);">ğŸ“‹ Clases Existentes</h3>
                <button id="btnRefrescarClases" class="btn btn-primary btn-small">ğŸ”„ Refrescar</button>
            </div>
            
            <div id="clasesListContainer" style="max-height: 500px; overflow-y: auto;">
                <!-- Las clases se cargan aquÃ­ dinÃ¡micamente -->
                <div style="text-align: center; padding: 20px; color: var(--text-muted);">
                    Cargando clases...
                </div>
            </div>
        </div>
    </div>
    
    <!-- EstadÃ­sticas visuales -->
    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-top: 20px;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 8px; text-align: center;">
            <div style="font-size: 0.9em; opacity: 0.9;">Total Clases</div>
            <div id="statsTotalClases" style="font-size: 2em; font-weight: bold;">0</div>
        </div>
        <div style="background: linear-gradient(135deg, #34a853 0%, #2ecc71 100%); color: white; padding: 15px; border-radius: 8px; text-align: center;">
            <div style="font-size: 0.9em; opacity: 0.9;">Activas</div>
            <div id="statsClasesActivas" style="font-size: 2em; font-weight: bold;">0</div>
        </div>
        <div style="background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); color: white; padding: 15px; border-radius: 8px; text-align: center;">
            <div style="font-size: 0.9em; opacity: 0.9;">PrÃ³ximas</div>
            <div id="statsClasesProximas" style="font-size: 2em; font-weight: bold;">0</div>
        </div>
        <div style="background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; padding: 15px; border-radius: 8px; text-align: center;">
            <div style="font-size: 0.9em; opacity: 0.9;">Solicitudes</div>
            <div id="statsTotalSolicitudesHistorico" style="font-size: 2em; font-weight: bold;">0</div>
        </div>
    </div>
</div>

    </div>

    <script src="/js/auth.js"></script>
    <script src="/js/admin.js"></script>
    <script src="/js/gestion-clases-visual.js"></script>
</body>
</html>